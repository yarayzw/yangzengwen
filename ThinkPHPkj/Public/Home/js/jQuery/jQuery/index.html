<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head> 
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
        <title>幸运大转盘</title>
        <meta name="keywords" content="大转盘抽奖" />
        <link rel="stylesheet" type="text/css" href="xinyun.css" />
        <style type="text/css">
            .demo{ position:relative;width:650px;}
            #disk{width:550px; height:550px; background:url(images/disk.jpg) no-repeat;}
            #start{width:163px; height:320px; position:absolute; top:64px; left:144px;}
            #start img{cursor:pointer}
        </style>
    </head>
    <body>
        <div class="container">
            <div class="demo">
                <div id="disk"></div>
                <div id="start"><img src="images/start.png" id="startbtn" alt="转盘开启" onclick="lottery()"
/></div>
            </div>  
        </div>
        <script type="text/javascript" src="jquery-1.11.2.min.js"></script>
        <script type="text/javascript" src="jQueryRotate.2.2.js"></script>
        <script type="text/javascript" src="jquery.easing.min.js"></script>
        <script type="text/javascript">
            /*$(function() {
                $("#startbtn").rotate({
                    bind: {
                        click: function() {
                            var random = Math.floor(Math.random() * 360); //生成随机数
                            $(this).rotate({
                                duration: 3000, //转动时间间隔（速度单位ms）
                                angle: 0, //指针开始角度
                                animateTo: 3600 + random, //转动角度，当转动角度到达3600+random度时停止转动。
                                easing: $.easing.easeOutSine, //easing动画效果
                                callback: function() {  //回调函数
                                    alert('恭喜您，中奖了！');
                                }
                            });
                        }
                    }
                });
            });*/

//            $(function() {
//                $("#startbtn").click(function() {
//                    lottery();
//                });
//            });
            function lottery() { 
                $.ajax({ 
                    type: 'POST', 
                    url: './Ajax.php', 
                    dataType: 'json', 
                    cache: false, 
                    error: function() { 
                        alert('Sorry，出错了！'); 
                        return false; 
                    }, 
                    success: function(json) { 
                        $("#startbtn").unbind('click').css("cursor", "default"); 
                        var angle = json.angle; //指针角度  
                        var prize = json.prize; //中奖奖项标题  
                        $("#startbtn").rotate({ 
                            duration: 2500,//转动时间 ms
                            angle: 0, //从0度开始 
                            animateTo: 3600 + angle,//转动角度  
                            easing: $.easing.easeOutSine, //easing扩展动画效果 
                            callback: function() { 
                                var resulte = confirm('恭喜您中得' + prize + '\n想要继续吗？');
                                if (resulte) { //若是点击确定，继续抽奖 
                                    lottery(); 
                                } 
                            } 
                        }); 
                    } 
                }); 
            }
        </script>

    </body>
</html>

